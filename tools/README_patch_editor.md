# PatchBank JSON Editor

`patch_bank.json`ファイルをグラフィカルに編集するためのPythonツールです。

## 機能

- JSONファイルの読み込み・保存
- パッチの一覧表示（GM楽器名付き）
- パッチの新規作成・削除
- パッチパラメーターの編集
  - プログラム番号（0-127）
  - モジュレーションモード（0-12）
  - フィードバック（0-255）
  - キーシフト（-24～+24）
- 8つのオペレーターの詳細編集
  - FU (MSB)（周波数上位8bit、0-255、16進数表示付き）
  - FL (LSB)（周波数下位8bit、0-255、16進数表示付き）
  - Frequency（合成値表示、0-65535、16進数表示付き）
  - Attack（0-255、スライダー付き）
  - Decay（0-255、スライダー付き）
  - Sustain（0-255、スライダー付き）
  - Release（0-255、スライダー付き）
  - Volume（0-255、スライダー付き）
  - Waveform（0-15、スライダー付き）

## 使用方法

### 1. 起動

```bash
python patch_editor.py
```

### 2. ファイル操作

- **開く**: メニューの「ファイル」→「開く」でJSONファイルを読み込み
- **保存**: メニューの「ファイル」→「保存」でJSONファイルを保存

### 3. パッチ編集

1. **パッチ選択**: 左側のリストからパッチを選択
2. **基本情報編集**: 右側上部でパッチの基本パラメーターを編集
3. **オペレーター編集**: 
   - OP0-OP7のラジオボタンでオペレーターを選択
   - 選択したオペレーターのパラメーターを編集

### 4. パッチ管理

- **新規パッチ**: 「新規パッチ」ボタンで空のパッチを作成
- **パッチ削除**: パッチを選択後「パッチ削除」ボタンで削除

## UIの説明

### 左パネル
- **パッチリスト**: 定義済みパッチの一覧（プログラム番号: GM楽器名）
- **新規パッチ/パッチ削除**: パッチの追加・削除ボタン

### 右パネル上部：パッチ情報
- **プログラム番号**: MIDIプログラム番号（0-127）
- **楽器名**: GM楽器名（自動表示）
- **モジュレーションモード**: FM合成のモード（0-12）
- **フィードバック**: フィードバック量（0-255）
- **キーシフト**: キー調整（-24～+24半音）

### 右パネル下部：オペレーター
- **OP0-OP7**: オペレーター選択ラジオボタン
- **FU (MSB)**: 周波数上位8bit（スピンボックス＋スライダー、16進数表示付き）
- **FL (LSB)**: 周波数下位8bit（スピンボックス＋スライダー、16進数表示付き）
- **Frequency**: 合成された周波数値（表示のみ、16進数表示付き）
- **Attack**: アタック時間（スピンボックス＋スライダー）
- **Decay**: ディケイ時間（スピンボックス＋スライダー）
- **Sustain**: サスティンレベル（スピンボックス＋スライダー）
- **Release**: リリース時間（スピンボックス＋スライダー）
- **Volume**: 音量（スピンボックス＋スライダー）
- **Waveform**: 波形選択（0-15、スピンボックス＋スライダー、16進数表示付き）

## 必要な環境

- Python 3.6以上
- tkinter（標準ライブラリ）

## JSONファイル形式

このエディターは以下の形式のJSONファイルに対応しています：

```json
{
  "patches": [
    {
      "program": 0,
      "modmode": 4,
      "feedback": 131,
      "keyShift": 0,
      "operators": [
        {
          "frequency": 0,
          "attack": 0,
          "decay": 64,
          "sustain": 0,
          "release": 16,
          "volume": 255,
          "waveform": 0
        },
        // ... 8つのオペレーター
      ]
    }
    // ... 他のパッチ
  ]
}
```

## 注意事項

- パラメーターは即座に反映されます
- ファイルの保存を忘れずに行ってください
- プログラム番号の重複は避けてください（新規作成時は自動で空き番号を選択）
- オペレーターは最大8個まで編集可能です

## トラブルシューティング

- **ファイルが開けない**: JSONファイルの形式が正しいか確認してください
- **パラメーターが反映されない**: パッチが選択されているか確認してください
- **保存できない**: ファイルの書き込み権限があるか確認してください